(function(){function y(){window.console&&window.console.warn&&window.console.warn.apply(window.console,arguments)}function p(n){i=w(n)}function w(n){return n.replace(/\/+$/,"")}function o(){window.document.getElementsByName("btcpay").length===0&&window.document.body.appendChild(n);h();n.style.display="block"}function a(){c();n.style.display="none";u=!1;n=window.document.body.removeChild(n)}function b(n){h=n}function k(n){c=n}function d(n){l=n}function g(n){var t;i.startsWith(n.origin)&&u&&(n.data==="close"?a():n.data==="loaded"?o():n.data&&n.data.open?(t=n.data.open,t.indexOf("bitcoin:")===0&&(window.location=t)):n.data&&n.data.mailto&&(t=n.data.mailto,t.indexOf("mailto:")===0&&(window.location=t)),l(n))}function nt(t,r){u=!0;window.document.body.appendChild(n);var f=i+"/invoice?id="+t+"&view=modal";r&&r.animateEntrance===!1&&(f+="&animateEntrance=false");n.src=f}function tt(){for(var i,n=window.document.querySelectorAll("[data-btcpay-button]"),t=0;t<n.length;t++)i=n[0],i.addEventListener("submit",o)}var u=!1,s=/\/modal\/btcpay\.js(\?v=.*)?$/,v="currentScript"in document,t="",r,f,n,i,e;if(v)t=document.currentScript.src;else for(r=0;r<document.scripts.length;r++)f=document.scripts[r],f.src.match(s)&&(t=f.src);if(window.btcpay){y("btcpay.js attempted to initialize more than once.");return}n=document.createElement("iframe");n.name="btcpay";n.class="btcpay";n.style.display="none";n.style.border=0;n.style.position="fixed";n.style.top=0;n.style.left=0;n.style.height="100%";n.style.width="100%";n.style.zIndex="2000";i="http://chat.btcpayserver.org join us there, and initialize this with your origin url through setApiUrlPrefix";e=t.match(s);e&&(i=t.substr(0,t.length-e[0].length));var h=function(){},c=function(){},l=function(){};window.addEventListener("load",function it(){window.removeEventListener("load",it)});window.addEventListener("message",g,!1);tt();window.btcpay={showFrame:o,hideFrame:a,showInvoice:nt,onModalWillEnter:b,onModalWillLeave:k,setApiUrlPrefix:p,onModalReceiveMessage:d}})();window.BTCPayShopifyIntegrationModule=function(){function p(){document.title=document.title.replace("Review and pay!","Thank you!");n.mainHeader.innerText="Thank you!";n.orderConfirmed&&(n.orderConfirmed.style.display="block");n.orderConfirmedDescription&&(n.orderConfirmedDescription.style.display="block");n.continueButton&&(n.continueButton.style.visibility="visible");n.checkMarkIcon&&(n.checkMarkIcon.style.visibility="visible");i&&(i.style.display="none")}function w(){document.title=document.title.replace("Thank you!","Review and pay!");n.mainHeader&&(n.mainHeader.innerText="Review and pay!");n.continueButton&&(n.continueButton.style.visibility="hidden");n.checkMarkIcon&&(n.checkMarkIcon.style.visibility="hidden");n.orderConfirmed&&(n.orderConfirmed.style.display="none");n.orderConfirmedDescription&&(n.orderConfirmedDescription.style.display="none")}function o(n){const t=e+"/stores/"+y+"/integrations/shopify/"+v+"?amount="+Shopify.checkout.payment_due+(n?"&checkonly=true":"");return fetch(t,{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",accept:"application/json"}}).then(function(n){return n.json()}).catch(function(){n||alert("Could not initiate BTCPay Server payment method, try again later.")})}function b(){i.innerHTML="<span>Displaying Invoice...<\/span>";o().then(s).catch(f.bind(this))}function s(n,t){if(r=n,!r){u?(window.btcpay.hideFrame(),f()):t&&t.backgroundCheck?l():f();return}["complete","confirmed","paid"].indexOf(r.status.toLowerCase())>=0?p():["invalid","expired"].indexOf(r.status.toLowerCase())>=0?f():t&&t.backgroundCheck||k()}function k(){if(r&&!u){u=!0;window.btcpay.setApiUrlPrefix(e);window.btcpay.onModalReceiveMessage(function(n){n&&n.invoiceId&&n.status&&(r=n)});window.btcpay.onModalWillEnter(function(){u=!0});window.btcpay.onModalWillLeave(function(){u=!1;o(!0).then(function(n){i.innerHTML=h;s(n,{backgroundCheck:!0})})});window.btcpay.showInvoice(r.invoiceId)}}function f(){r=null;i.innerHTML=h}function l(){(i=document.getElementById("btcpayserver-pay"),i)||(i=document.createElement("div"),i.id="btcpayserver-pay",i.innerHTML=h,a(i,n.orderConfirmed))}var c,r,u,n;const t=document.querySelector.bind(document),a=(document.querySelectorAll.bind(document),(n,t)=>{t.parentNode.insertBefore(n,t.nextSibling)});if(c=t(".payment-method-list__item__info"),null===c)return void setTimeout(()=>{window.BTCPayShopifyIntegrationModule()},10);if(!window.btcpay)throw new Error("The BTCPay modal js was not loaded on this page.");if(!window.Shopify)throw new Error("The Shopify global object was not loaded on this page.");if(!window.BTCPAYSERVER_URL||!window.STORE_ID)throw new Error("The BTCPAYSERVER_URL STORE_ID global vars were not set on this page.");const v=Shopify.checkout.order_id,e=window.BTCPAYSERVER_URL,y=window.STORE_ID;u=!1;let i=null;n={mainHeader:t("#main-header"),orderConfirmed:t(".os-step__title"),orderConfirmedDescription:t(".os-step__description"),continueButton:t(".step__footer__continue-btn"),checkMarkIcon:t(".os-header__hanging-icon"),orderStatus:t(".os-header__title"),paymentMethod:t(".payment-method-list__item__info"),price:t(".payment-due__price"),finalPrice:t(".total-recap__final-price"),orderNumber:t(".os-order-number")};const h='<button class="" onclick="onPayButtonClicked()" style="width:210px; border: none; outline: none;"><img src="'+e+'/img/paybutton/pay.svg"><\/button>';["bitcoin","btc","btcpayserver","btcpay server"].filter(t=>n.paymentMethod.innerText.toLowerCase().indexOf(t)!==-1).length!==0&&(w(),window.onPayButtonClicked=b.bind(this),o(!0).then(function(n){l();s(n,{backgroundCheck:!0})}))};window.BTCPayShopifyIntegrationModule();